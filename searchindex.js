Search.setIndex({"docnames": ["examples/twiss", "index", "modules/convert", "modules/invariant", "modules/matrix", "modules/normal", "modules/transport", "modules/twiss", "modules/util"], "filenames": ["examples/twiss.ipynb", "index.rst", "modules/convert.rst", "modules/invariant.rst", "modules/matrix.rst", "modules/normal.rst", "modules/transport.rst", "modules/twiss.rst", "modules/util.rst"], "titles": ["Example-01: Coupled twiss parameters", "Welcome to twiss\u2019s documentation!", "Convert", "Invariant", "Matrix", "Normal", "Transport", "Twiss", "Math"], "terms": {"1": [0, 2, 3, 4, 5, 6, 7, 8], "import": [0, 2, 3, 4, 5, 6, 7, 8], "torch": [0, 2, 3, 4, 5, 6, 7], "set_printopt": 0, "precis": 0, "3": [0, 7], "sci_mod": 0, "true": [0, 2, 3, 4, 5, 6, 7], "2": [0, 2, 3, 4, 5, 6, 7, 8], "set": 0, "element": [0, 5], "def": [0, 7], "drif": 0, "x": [0, 3, 5, 6, 8], "l": 0, "qx": 0, "px": 0, "qy": 0, "py": 0, "return": [0, 2, 3, 4, 5, 6, 7, 8], "stack": [0, 6, 7], "quad": 0, "kn": 0, "k": [0, 7], "n": [0, 2, 3, 4, 5, 7], "25": 0, "0": [0, 2, 3, 4, 5, 6, 7, 8], "_": [0, 6, 7], "rang": 0, "transport": [0, 1, 7], "map": [0, 7], "m11": 0, "kn1": 0, "ks1": 0, "kn2": 0, "ks2": 0, "m12": 0, "5": [0, 8], "m23": 0, "m34": 0, "m45": 0, "m56": 0, "m67": 0, "m78": 0, "m89": 0, "4": [0, 8], "fodo": 0, "cell": 0, "comput": [0, 1, 3, 4, 5, 6, 7], "one": [0, 5, 7], "turn": [0, 3, 5, 7], "matrix": [0, 1, 2, 3, 5, 6, 7], "tensor": [0, 2, 3, 4, 5, 6, 7], "dtype": [0, 2, 3, 4, 5, 6, 7], "float64": [0, 2, 3, 4, 5, 6, 7], "20": 0, "m": [0, 2, 3, 4, 5, 6, 7], "func": [0, 3, 6, 7], "jacrev": 0, "print": 0, "is_stabl": [0, 1, 7], "946e": 0, "032e": 0, "8": 0, "454e": 0, "297e": 0, "725e": 0, "386e": 0, "052e": 0, "9": [0, 7], "236e": 0, "539e": 0, "00": [0, 4, 6, 7], "806e": 0, "6": 0, "t": [0, 2, 3, 5, 6, 7], "w": [0, 2, 3, 5, 7], "677e": 0, "647e": 0, "835e": 0, "000e": 0, "714e": 0, "814e": 0, "16": [0, 4, 6], "488e": 0, "18": 0, "069e": 0, "388e": 0, "7": 0, "283e": 0, "634e": 0, "239e": 0, "17": [0, 6, 7], "884e": 0, "707e": 0, "980e": 0, "640e": 0, "308e": 0, "338e": 0, "137e": 0, "208e": 0, "252e": 0, "279e": 0, "127e": 0, "165e": 0, "401e": 0, "288e": 0, "880e": 0, "367e": 0, "142e": 0, "114e": 0, "566e": 0, "305e": 0, "384e": 0, "866e": 0, "550e": 0, "974e": 0, "818e": 0, "check": [0, 7], "normal": [0, 1, 3, 6, 7], "math": [0, 1, 2, 3, 4, 5, 6, 7], "pi": [0, 2, 3, 4, 5, 6, 7, 8], "rotat": [0, 1, 2, 3, 4, 5, 6, 7], "invers": [0, 4], "945e": 0, "692e": 0, "224e": 0, "957e": 0, "082e": 0, "816e": 0, "772e": 0, "424e": 0, "578e": 0, "matric": [0, 1, 2, 5, 6, 7], "symplectic_ident": [0, 1, 4], "": [0, 7], "len": 0, "u": [0, 2, 3, 5], "zeros_lik": [0, 7], "ti": 0, "wi": 0, "zip": [0, 6], "sin": [0, 4, 7], "co": [0, 4, 7], "each": [0, 3], "locat": [0, 6], "propag": [0, 1, 6, 7], "out": 0, "append": 0, "shape": [0, 7], "size": 0, "10": 0, "convert": [0, 1, 3, 6], "c": [0, 2, 3, 5, 6], "lb": [0, 2, 3, 5, 6], "represenc": 0, "wolski_to_c": [0, 1, 2, 3, 6], "wolski_to_lb": [0, 1, 2, 3, 6], "ax": [0, 2, 3, 5], "bx": [0, 2, 3, 5], "ai": [0, 2, 3, 5], "vmap": [0, 3, 6, 7], "a1x": [0, 2, 3, 5], "b1x": [0, 2, 3, 5], "a2x": [0, 2, 3, 5], "b2x": [0, 2, 3, 5], "a1i": [0, 2, 3, 5], "b1y": [0, 2, 3, 5], "a2i": [0, 2, 3, 5], "b2y": [0, 2, 3, 5], "11": 0, "plot": 0, "plane": [0, 2, 4, 5, 7], "matplotlib": 0, "pyplot": 0, "plt": 0, "figur": 0, "figsiz": 0, "marker": 0, "o": [0, 7], "color": 0, "blue": 0, "red": 0, "show": 0, "12": [0, 2, 3, 4, 5, 6, 7], "13": 0, "mu": 0, "sum": 0, "14": 0, "accumul": 0, "mux": 0, "mui": 0, "cumsum": 0, "fn": [0, 7], "d1": 0, "d2": 0, "832e": 0, "027e": 0, "894e": 0, "430e": 0, "265e": 0, "186e": 0, "682e": 0, "547e": 0, "998e": 0, "576e": 0, "716e": 0, "931e": 0, "011e": 0, "286e": 0, "test": [0, 4], "dk": 0, "005": 0, "674e": 0, "645e": 0, "740e": 0, "702e": 0, "741e": 0, "703e": 0, "task": 0, "function": [0, 7], "341e": 0, "226e": 0, "274e": 0, "608e": 0, "173e": 0, "554e": 0, "444e": 0, "723e": 0, "834e": 0, "303e": 0, "188e": 0, "232e": 0, "251e": 0, "827e": 0, "395e": 0, "370e": 0, "856e": 0, "190e": 0, "234e": 0, "262e": 0, "838e": 0, "396e": 0, "648e": 0, "373e": 0, "742e": 0, "857e": 0, "172e": 0, "490e": 0, "759e": 0, "918e": 0, "375e": 0, "567e": 0, "088e": 0, "784e": 0, "528e": 0, "883e": 0, "357e": 0, "435e": 0, "691e": 0, "086e": 0, "752e": 0, "206e": 0, "527e": 0, "368e": 0, "438e": 0, "694e": 0, "085e": 0, "751e": 0, "grad": 0, "given": [0, 3, 4, 5, 6, 7], "known": 0, "knob": 0, "uncertanti": 0, "sk": 0, "st": 0, "sqrt": [0, 7], "randn": 0, "1024": 0, "std": 0, "900e": 0, "459e": 0, "971e": 0, "484e": 0, "object": 0, "focus": 0, "quadrupol": 0, "center": 0, "BY": 0, "bag": 0, "flag": 0, "fals": [0, 7], "optim": 0, "adam": 0, "count": 0, "lr": 0, "beta": 0, "900": 0, "999": 0, "epsilon": [0, 2, 4, 5, 7], "0e": [0, 2, 5, 7], "b1": 0, "b2": 0, "history_knob": 0, "history_valu": 0, "m1": 0, "m2": 0, "i": [0, 3, 4, 5, 7, 8], "f1": 0, "f2": 0, "valu": 0, "tupl": [0, 6, 7], "128": 0, "001": 0, "bys": 0, "cpu": [0, 4], "numpi": 0, "defin": 0, "class": 0, "nn": 0, "modul": [0, 1], "__init__": 0, "self": 0, "super": 0, "clone": 0, "forward": 0, "train": 0, "note": 0, "here": 0, "method": 0, "loss": 0, "256": 0, "backward": 0, "step": 0, "zero_grad": 0, "result": 0, "detach": 0, "squeez": 0, "500e": 0, "parametr": [0, 1, 5], "ndtorch": 0, "evalu": 0, "lambda": [0, 3], "jacobian": 0, "jacfwd": [0, 7], "mse": 0, "mseloss": 0, "data": [0, 4, 6], "item": 0, "black": 0, "coupl": [1, 7], "paramet": [1, 2, 3, 4, 5, 6, 7, 8], "wolski": [1, 2, 5, 6, 7], "arbitrari": [1, 7], "even": [1, 3, 4, 5, 6, 7], "dimens": [1, 3, 4, 5, 6, 7], "01": [1, 6, 7], "02": [1, 7], "tune": [1, 5, 7], "deriv": 1, "03": 1, "04": 1, "phase": [1, 6, 7], "advanc": [1, 6, 7], "05": 1, "uncertainti": 1, "from": [1, 2, 3, 4, 5, 6, 7, 8], "systemat": 1, "error": 1, "06": 1, "match": 1, "compos": 1, "07": 1, "autograd": 1, "08": 1, "taylor": 1, "model": 1, "mod": [1, 7, 8], "is_symplect": [1, 4, 5], "project": [1, 4], "rotation_block": [1, 4], "symplectic_block": [1, 4], "symplectic_invers": [1, 4], "symplectifi": [1, 4], "cs_normal": [1, 5], "lb_normal": [1, 5], "normal_to_wolski": [1, 5, 6], "wolski_to_norm": [1, 5], "cs_to_wolski": [1, 2], "lb_to_wolski": [1, 2], "invari": 1, "cs_invari": [1, 3], "lb_invari": [1, 3], "cs_transport": [1, 6], "lb_transport": [1, 6], "momenta": [1, 6], "wolski_transport": [1, 6], "index": 1, "search": 1, "page": 1, "between": [2, 6], "differ": 2, "twiss": [2, 3, 4, 5, 6, 8], "represent": 2, "par": [2, 5], "sourc": [2, 3, 4, 5, 6, 7, 8], "courant": [2, 5], "snyder": [2, 5], "float": [2, 4, 5, 7], "option": [2, 5], "default": [2, 4, 5, 7, 8], "toler": [2, 4, 5, 7], "type": [2, 3, 4, 5, 6, 7, 8], "ar": [2, 4, 5, 7], "exampl": [2, 3, 4, 5, 6, 7, 8], "19": 2, "allclos": [2, 3, 5, 6], "lebedev": [2, 5], "bogacz": [2, 5], "v1": [2, 3, 5], "v2": [2, 3, 5], "util": [3, 4, 5, 6, 8], "orbit": 3, "linear": 3, "jx": 3, "jy": 3, "assum": [3, 7], "have": [3, 7, 8], "form": 3, "qx_i": 3, "px_i": 3, "qy_i": 3, "py_i": 3, "31": [3, 6], "symplect": [3, 4, 5, 6, 7], "1e": [4, 5, 7], "bool": [4, 7], "condit": [4, 5], "input": [4, 7, 8], "elementwis": 4, "d": 4, "int": [4, 8], "p": 4, "devic": 4, "total": 4, "number": 4, "id": 4, "angl": 4, "gener": [4, 5, 6], "us": [4, 5, 6], "block": [4, 7], "0000e": [4, 6], "2246e": 4, "2d": 4, "output": [4, 7], "ident": 4, "configur": 4, "space": 4, "posit": [4, 6], "e": 4, "canon": 4, "variabl": 4, "group": 4, "pair": 4, "0000": [4, 6, 7], "1000": [4, 6, 7], "perform": 4, "symplectif": 4, "99": 4, "0050": 4, "1005": 4, "9950": 4, "r": [5, 7], "88": [5, 7], "4x4": 5, "free": 5, "n11": 5, "n33": 5, "n21": 5, "n43": 5, "n13": 5, "n31": 5, "n14": 5, "n41": 5, "denot": 5, "For": 5, "all": [5, 6, 8], "singular": 5, "uncoupl": 5, "limit": 5, "fake": 5, "fix": 5, "pars1": 6, "pars2": 6, "mu12": 6, "1st": 6, "2nd": 6, "block_diag": 6, "n1": 6, "w1": 6, "n2": 6, "w2": 6, "7756e": 6, "5959e": 6, "3878e": [6, 7], "qx1": 6, "qx2": 6, "qy1": 6, "qy2": 6, "coordin": 6, "y": [6, 8], "px1": 6, "px2": 6, "py1": 6, "py2": 6, "x1": 6, "x2": 6, "standard": 7, "gaug": 7, "stabl": 7, "can": 7, "main": 7, "over": 7, "batch": 7, "differenti": 7, "final": 7, "0997": 7, "0050e": 7, "9504e": 7, "stabil": 7, "eigenvalu": 7, "unit": 7, "circl": 7, "1234": 7, "throught": 7, "w_i": 7, "0100": 7, "fraction": 7, "alpha": 7, "complex": 7, "1j": 7, "order": 7, "t_i": 7, "8800": 7, "linspac": 7, "2000": 7, "3000": 7, "4000": 7, "5000": 7, "6000": 7, "7000": 7, "8000": 7, "9000": 7, "ones_lik": 7, "reshap": 7, "0796": 7, "ani": 8, "z": 8, "remaind": 8, "divis": 8, "offset": 8, "numer": 8, "denomen": 8, "onli": 8, "argument": 8, "5707963267948966": 8, "71238898038469": 8}, "objects": {"twiss": [[2, 0, 0, "-", "convert"], [3, 0, 0, "-", "invariant"], [4, 0, 0, "-", "matrix"], [5, 0, 0, "-", "normal"], [6, 0, 0, "-", "transport"], [7, 0, 0, "-", "twiss"], [8, 0, 0, "-", "util"]], "twiss.convert": [[2, 1, 1, "", "cs_to_wolski"], [2, 1, 1, "", "lb_to_wolski"], [2, 1, 1, "", "wolski_to_cs"], [2, 1, 1, "", "wolski_to_lb"]], "twiss.invariant": [[3, 1, 1, "", "cs_invariant"], [3, 1, 1, "", "invariant"], [3, 1, 1, "", "lb_invariant"]], "twiss.matrix": [[4, 1, 1, "", "is_symplectic"], [4, 1, 1, "", "projection"], [4, 1, 1, "", "rotation"], [4, 1, 1, "", "rotation_block"], [4, 1, 1, "", "symplectic_block"], [4, 1, 1, "", "symplectic_identity"], [4, 1, 1, "", "symplectic_inverse"], [4, 1, 1, "", "symplectify"]], "twiss.normal": [[5, 1, 1, "", "cs_normal"], [5, 1, 1, "", "lb_normal"], [5, 1, 1, "", "normal_to_wolski"], [5, 1, 1, "", "parametric"], [5, 1, 1, "", "wolski_to_normal"]], "twiss.transport": [[6, 1, 1, "", "cs_transport"], [6, 1, 1, "", "lb_transport"], [6, 1, 1, "", "momenta"], [6, 1, 1, "", "transport"], [6, 1, 1, "", "wolski_transport"]], "twiss.twiss": [[7, 1, 1, "", "advance"], [7, 1, 1, "", "is_stable"], [7, 1, 1, "", "propagate"], [7, 1, 1, "", "twiss"]], "twiss.util": [[8, 1, 1, "", "mod"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"exampl": [0, 1], "01": 0, "coupl": 0, "twiss": [0, 1, 7], "paramet": 0, "02": 0, "tune": 0, "deriv": 0, "03": 0, "04": 0, "phase": 0, "advanc": 0, "05": 0, "uncertainti": 0, "from": 0, "systemat": 0, "error": 0, "06": 0, "match": 0, "compos": 0, "07": 0, "autograd": 0, "08": 0, "taylor": 0, "model": 0, "welcom": 1, "": 1, "document": 1, "api": 1, "indic": 1, "tabl": 1, "convert": 2, "invari": 3, "matrix": 4, "normal": 5, "transport": 6, "math": 8}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Example-01: Coupled twiss parameters": [[0, "Example-01:-Coupled-twiss-parameters"]], "Example-02: Tune derivatives": [[0, "Example-02:-Tune-derivatives"]], "Example-03: Twiss derivatives": [[0, "Example-03:-Twiss-derivatives"]], "Example-04: Phase advance derivatives": [[0, "Example-04:-Phase-advance-derivatives"]], "Example-05: Tune uncertainty from systematic errors": [[0, "Example-05:-Tune-uncertainty-from-systematic-errors"]], "Example-06: Matching (composable)": [[0, "Example-06:-Matching-(composable)"]], "Example-07: Matching (autograd)": [[0, "Example-07:-Matching-(autograd)"]], "Example-08: Matching (autograd & taylor model)": [[0, "Example-08:-Matching-(autograd-&-taylor-model)"]], "Welcome to twiss\u2019s documentation!": [[1, "welcome-to-twiss-s-documentation"]], "Examples:": [[1, null]], "API:": [[1, null]], "Indices and tables": [[1, "indices-and-tables"]], "Convert": [[2, "convert"]], "Invariant": [[3, "invariant"]], "Matrix": [[4, "matrix"]], "Normal": [[5, "normal"]], "Transport": [[6, "transport"]], "Twiss": [[7, "twiss"]], "Math": [[8, "math"]]}, "indexentries": {"cs_to_wolski() (in module twiss.convert)": [[2, "twiss.convert.cs_to_wolski"]], "lb_to_wolski() (in module twiss.convert)": [[2, "twiss.convert.lb_to_wolski"]], "module": [[2, "module-twiss.convert"], [3, "module-twiss.invariant"], [4, "module-twiss.matrix"], [5, "module-twiss.normal"], [6, "module-twiss.transport"], [7, "module-twiss.twiss"], [8, "module-twiss.util"]], "twiss.convert": [[2, "module-twiss.convert"]], "wolski_to_cs() (in module twiss.convert)": [[2, "twiss.convert.wolski_to_cs"]], "wolski_to_lb() (in module twiss.convert)": [[2, "twiss.convert.wolski_to_lb"]], "cs_invariant() (in module twiss.invariant)": [[3, "twiss.invariant.cs_invariant"]], "invariant() (in module twiss.invariant)": [[3, "twiss.invariant.invariant"]], "lb_invariant() (in module twiss.invariant)": [[3, "twiss.invariant.lb_invariant"]], "twiss.invariant": [[3, "module-twiss.invariant"]], "is_symplectic() (in module twiss.matrix)": [[4, "twiss.matrix.is_symplectic"]], "projection() (in module twiss.matrix)": [[4, "twiss.matrix.projection"]], "rotation() (in module twiss.matrix)": [[4, "twiss.matrix.rotation"]], "rotation_block() (in module twiss.matrix)": [[4, "twiss.matrix.rotation_block"]], "symplectic_block() (in module twiss.matrix)": [[4, "twiss.matrix.symplectic_block"]], "symplectic_identity() (in module twiss.matrix)": [[4, "twiss.matrix.symplectic_identity"]], "symplectic_inverse() (in module twiss.matrix)": [[4, "twiss.matrix.symplectic_inverse"]], "symplectify() (in module twiss.matrix)": [[4, "twiss.matrix.symplectify"]], "twiss.matrix": [[4, "module-twiss.matrix"]], "cs_normal() (in module twiss.normal)": [[5, "twiss.normal.cs_normal"]], "lb_normal() (in module twiss.normal)": [[5, "twiss.normal.lb_normal"]], "normal_to_wolski() (in module twiss.normal)": [[5, "twiss.normal.normal_to_wolski"]], "parametric() (in module twiss.normal)": [[5, "twiss.normal.parametric"]], "twiss.normal": [[5, "module-twiss.normal"]], "wolski_to_normal() (in module twiss.normal)": [[5, "twiss.normal.wolski_to_normal"]], "cs_transport() (in module twiss.transport)": [[6, "twiss.transport.cs_transport"]], "lb_transport() (in module twiss.transport)": [[6, "twiss.transport.lb_transport"]], "momenta() (in module twiss.transport)": [[6, "twiss.transport.momenta"]], "transport() (in module twiss.transport)": [[6, "twiss.transport.transport"]], "twiss.transport": [[6, "module-twiss.transport"]], "wolski_transport() (in module twiss.transport)": [[6, "twiss.transport.wolski_transport"]], "advance() (in module twiss.twiss)": [[7, "twiss.twiss.advance"]], "is_stable() (in module twiss.twiss)": [[7, "twiss.twiss.is_stable"]], "propagate() (in module twiss.twiss)": [[7, "twiss.twiss.propagate"]], "twiss() (in module twiss.twiss)": [[7, "twiss.twiss.twiss"]], "twiss.twiss": [[7, "module-twiss.twiss"]], "mod() (in module twiss.util)": [[8, "twiss.util.mod"]], "twiss.util": [[8, "module-twiss.util"]]}})