Search.setIndex({"docnames": ["examples/twiss", "index", "modules/convert", "modules/invariant", "modules/math", "modules/matrix", "modules/normal", "modules/transport", "modules/twiss"], "filenames": ["examples/twiss.ipynb", "index.rst", "modules/convert.rst", "modules/invariant.rst", "modules/math.rst", "modules/matrix.rst", "modules/normal.rst", "modules/transport.rst", "modules/twiss.rst"], "titles": ["Example-01: Coupled twiss parameters", "Welcome to twiss\u2019s documentation!", "Convert", "Invariant", "Math", "Matrix", "Normal", "Transport", "Twiss"], "terms": {"1": [0, 2, 3, 4, 5, 6, 7, 8], "import": [0, 2, 3, 4, 5, 6, 7, 8], "torch": [0, 2, 3, 5, 6, 7, 8], "set_printopt": 0, "precis": 0, "3": [0, 8], "sci_mod": 0, "true": [0, 2, 3, 5, 6, 7, 8], "2": [0, 2, 3, 4, 5, 6, 7, 8], "set": 0, "element": [0, 6], "def": [0, 8], "drif": 0, "x": [0, 3, 4, 6, 7], "l": 0, "qx": 0, "px": 0, "qy": 0, "py": 0, "return": [0, 2, 3, 4, 5, 6, 7, 8], "stack": [0, 7, 8], "quad": 0, "kn": 0, "k": [0, 8], "n": [0, 2, 3, 5, 6, 8], "25": 0, "0": [0, 2, 3, 4, 5, 6, 7, 8], "_": [0, 7, 8], "rang": 0, "transport": [0, 1, 8], "map": [0, 8], "m11": 0, "kn1": 0, "ks1": 0, "kn2": 0, "ks2": 0, "m12": 0, "5": [0, 4], "m23": 0, "m34": 0, "m45": 0, "m56": 0, "m67": 0, "m78": 0, "m89": 0, "4": [0, 4], "fodo": 0, "cell": 0, "comput": [0, 1, 3, 5, 6, 7, 8], "one": [0, 6, 8], "turn": [0, 3, 6, 8], "matrix": [0, 1, 2, 3, 6, 7, 8], "tensor": [0, 2, 3, 5, 6, 7, 8], "dtype": [0, 2, 3, 5, 6, 7, 8], "float64": [0, 2, 3, 5, 6, 7, 8], "20": 0, "m": [0, 2, 3, 5, 6, 7, 8], "func": [0, 3, 7, 8], "jacrev": 0, "print": 0, "is_stabl": [0, 1, 8], "946e": 0, "032e": 0, "8": 0, "454e": 0, "297e": 0, "725e": 0, "386e": 0, "052e": 0, "9": [0, 8], "236e": 0, "539e": 0, "00": [0, 5, 7, 8], "806e": 0, "6": 0, "t": [0, 2, 3, 6, 7, 8], "w": [0, 2, 3, 6, 8], "677e": 0, "647e": 0, "835e": 0, "000e": 0, "714e": 0, "814e": 0, "16": [0, 5, 7], "488e": 0, "18": 0, "069e": 0, "388e": 0, "7": 0, "283e": 0, "634e": 0, "239e": 0, "17": [0, 7, 8], "884e": 0, "707e": 0, "980e": 0, "640e": 0, "308e": 0, "338e": 0, "137e": 0, "208e": 0, "252e": 0, "279e": 0, "127e": 0, "165e": 0, "401e": 0, "288e": 0, "880e": 0, "367e": 0, "142e": 0, "114e": 0, "566e": 0, "305e": 0, "384e": 0, "866e": 0, "550e": 0, "974e": 0, "818e": 0, "check": [0, 8], "normal": [0, 1, 3, 7, 8], "math": [0, 1, 2, 3, 5, 6, 7, 8], "pi": [0, 2, 3, 4, 5, 6, 7, 8], "rotat": [0, 1, 2, 3, 5, 6, 7, 8], "invers": [0, 5], "945e": 0, "692e": 0, "224e": 0, "957e": 0, "082e": 0, "816e": 0, "772e": 0, "424e": 0, "578e": 0, "matric": [0, 1, 2, 6, 7, 8], "symplectic_ident": [0, 1, 5], "": [0, 8], "len": 0, "u": [0, 2, 3, 6], "zeros_lik": [0, 8], "ti": 0, "wi": 0, "zip": [0, 7], "sin": [0, 5, 8], "co": [0, 5, 8], "each": [0, 3], "locat": [0, 7], "propag": [0, 1, 7, 8], "out": 0, "append": 0, "shape": [0, 8], "size": 0, "10": 0, "convert": [0, 1, 3, 7], "c": [0, 2, 3, 6, 7], "lb": [0, 2, 3, 6, 7], "represenc": 0, "wolski_to_c": [0, 1, 2, 3, 7], "wolski_to_lb": [0, 1, 2, 3, 7], "ax": [0, 2, 3, 6], "bx": [0, 2, 3, 6], "ai": [0, 2, 3, 6], "vmap": [0, 3, 7, 8], "a1x": [0, 2, 3, 6], "b1x": [0, 2, 3, 6], "a2x": [0, 2, 3, 6], "b2x": [0, 2, 3, 6], "a1i": [0, 2, 3, 6], "b1y": [0, 2, 3, 6], "a2i": [0, 2, 3, 6], "b2y": [0, 2, 3, 6], "11": 0, "plot": 0, "plane": [0, 2, 5, 6, 8], "matplotlib": 0, "pyplot": 0, "plt": 0, "figur": 0, "figsiz": 0, "marker": 0, "o": [0, 8], "color": 0, "blue": 0, "red": 0, "show": 0, "12": [0, 2, 3, 5, 6, 7, 8], "13": 0, "mu": 0, "sum": 0, "14": 0, "accumul": 0, "mux": 0, "mui": 0, "cumsum": 0, "fn": [0, 8], "d1": 0, "d2": 0, "832e": 0, "027e": 0, "894e": 0, "430e": 0, "265e": 0, "186e": 0, "682e": 0, "547e": 0, "998e": 0, "576e": 0, "716e": 0, "931e": 0, "011e": 0, "286e": 0, "test": [0, 5], "dk": 0, "005": 0, "674e": 0, "645e": 0, "740e": 0, "702e": 0, "741e": 0, "703e": 0, "task": 0, "function": [0, 8], "341e": 0, "226e": 0, "274e": 0, "608e": 0, "173e": 0, "554e": 0, "444e": 0, "723e": 0, "834e": 0, "303e": 0, "188e": 0, "232e": 0, "251e": 0, "827e": 0, "395e": 0, "370e": 0, "856e": 0, "190e": 0, "234e": 0, "262e": 0, "838e": 0, "396e": 0, "648e": 0, "373e": 0, "742e": 0, "857e": 0, "172e": 0, "490e": 0, "759e": 0, "918e": 0, "375e": 0, "567e": 0, "088e": 0, "784e": 0, "528e": 0, "883e": 0, "357e": 0, "435e": 0, "691e": 0, "086e": 0, "752e": 0, "206e": 0, "527e": 0, "368e": 0, "438e": 0, "694e": 0, "085e": 0, "751e": 0, "grad": 0, "given": [0, 3, 5, 6, 7, 8], "known": 0, "knob": 0, "uncertanti": 0, "sk": 0, "st": 0, "sqrt": [0, 8], "randn": 0, "1024": 0, "std": 0, "900e": 0, "459e": 0, "971e": 0, "484e": 0, "object": 0, "focus": 0, "quadrupol": 0, "center": 0, "BY": 0, "bag": 0, "flag": 0, "fals": [0, 8], "optim": 0, "adam": 0, "count": 0, "lr": 0, "beta": 0, "900": 0, "999": 0, "epsilon": [0, 2, 5, 6, 8], "0e": [0, 2, 6, 8], "b1": 0, "b2": 0, "history_knob": 0, "history_valu": 0, "m1": 0, "m2": 0, "i": [0, 3, 4, 5, 6, 8], "f1": 0, "f2": 0, "valu": 0, "tupl": [0, 7, 8], "128": 0, "001": 0, "bys": 0, "cpu": [0, 5], "numpi": 0, "defin": 0, "class": 0, "nn": 0, "modul": [0, 1], "__init__": 0, "self": 0, "super": 0, "clone": 0, "forward": 0, "train": 0, "note": 0, "here": 0, "method": 0, "loss": 0, "256": 0, "backward": 0, "step": 0, "zero_grad": 0, "result": 0, "detach": 0, "squeez": 0, "500e": 0, "parametr": [0, 1, 6], "ndtorch": 0, "evalu": 0, "lambda": [0, 3], "jacobian": 0, "jacfwd": [0, 8], "mse": 0, "mseloss": 0, "data": [0, 5, 7], "item": 0, "black": 0, "coupl": [1, 8], "paramet": [1, 2, 3, 4, 5, 6, 7, 8], "wolski": [1, 2, 6, 7, 8], "arbitrari": [1, 8], "even": [1, 3, 5, 6, 7, 8], "dimens": [1, 3, 5, 6, 7, 8], "01": [1, 7, 8], "02": [1, 8], "tune": [1, 6, 8], "deriv": 1, "03": 1, "04": 1, "phase": [1, 7, 8], "advanc": [1, 7, 8], "05": 1, "uncertainti": 1, "from": [1, 2, 3, 4, 5, 6, 7, 8], "systemat": 1, "error": 1, "06": 1, "match": 1, "compos": 1, "07": 1, "autograd": 1, "08": 1, "taylor": 1, "model": 1, "mod": [1, 4, 8], "is_symplect": [1, 5, 6], "project": [1, 5], "rotation_block": [1, 5], "symplectic_block": [1, 5], "symplectic_invers": [1, 5], "symplectifi": [1, 5], "cs_normal": [1, 6], "lb_normal": [1, 6], "normal_to_wolski": [1, 6, 7], "wolski_to_norm": [1, 6], "cs_to_wolski": [1, 2], "lb_to_wolski": [1, 2], "invari": 1, "cs_invari": [1, 3], "lb_invari": [1, 3], "cs_transport": [1, 7], "lb_transport": [1, 7], "momenta": [1, 7], "wolski_transport": [1, 7], "index": 1, "search": 1, "page": 1, "between": [2, 7], "differ": 2, "twiss": [2, 3, 4, 5, 6, 7], "represent": 2, "par": [2, 6], "sourc": [2, 3, 4, 5, 6, 7, 8], "courant": [2, 6], "snyder": [2, 6], "float": [2, 5, 6, 8], "option": [2, 6], "default": [2, 4, 5, 6, 8], "toler": [2, 5, 6, 8], "type": [2, 3, 4, 5, 6, 7, 8], "ar": [2, 5, 6, 8], "exampl": [2, 3, 4, 5, 6, 7, 8], "19": 2, "allclos": [2, 3, 6, 7], "lebedev": [2, 6], "bogacz": [2, 6], "v1": [2, 3, 6], "v2": [2, 3, 6], "util": [3, 4, 5, 6, 7], "orbit": 3, "linear": 3, "jx": 3, "jy": 3, "assum": [3, 8], "have": [3, 4, 8], "form": 3, "qx_i": 3, "px_i": 3, "qy_i": 3, "py_i": 3, "31": [3, 7], "symplect": [3, 5, 6, 7, 8], "ani": 4, "y": [4, 7], "z": 4, "remaind": 4, "divis": 4, "offset": 4, "numer": 4, "denomen": 4, "int": [4, 5], "onli": 4, "all": [4, 6, 7], "input": [4, 5, 8], "argument": 4, "5707963267948966": 4, "71238898038469": 4, "1e": [5, 6, 8], "bool": [5, 8], "condit": [5, 6], "elementwis": 5, "d": 5, "p": 5, "devic": 5, "total": 5, "number": 5, "id": 5, "angl": 5, "gener": [5, 6, 7], "us": [5, 6, 7], "block": [5, 8], "0000e": [5, 7], "2246e": 5, "2d": 5, "output": [5, 8], "ident": 5, "configur": 5, "space": 5, "posit": [5, 7], "e": 5, "canon": 5, "variabl": 5, "group": 5, "pair": 5, "0000": [5, 7, 8], "1000": [5, 7, 8], "perform": 5, "symplectif": 5, "99": 5, "0050": 5, "1005": 5, "9950": 5, "r": [6, 8], "88": [6, 8], "4x4": 6, "free": 6, "n11": 6, "n33": 6, "n21": 6, "n43": 6, "n13": 6, "n31": 6, "n14": 6, "n41": 6, "denot": 6, "For": 6, "singular": 6, "uncoupl": 6, "limit": 6, "fake": 6, "fix": 6, "pars1": 7, "pars2": 7, "mu12": 7, "1st": 7, "2nd": 7, "block_diag": 7, "n1": 7, "w1": 7, "n2": 7, "w2": 7, "7756e": 7, "5959e": 7, "3878e": [7, 8], "qx1": 7, "qx2": 7, "qy1": 7, "qy2": 7, "coordin": 7, "px1": 7, "px2": 7, "py1": 7, "py2": 7, "x1": 7, "x2": 7, "standard": 8, "gaug": 8, "stabl": 8, "can": 8, "main": 8, "over": 8, "batch": 8, "differenti": 8, "final": 8, "0997": 8, "0050e": 8, "9504e": 8, "stabil": 8, "eigenvalu": 8, "unit": 8, "circl": 8, "1234": 8, "throught": 8, "w_i": 8, "0100": 8, "fraction": 8, "alpha": 8, "complex": 8, "1j": 8, "order": 8, "t_i": 8, "8800": 8, "linspac": 8, "2000": 8, "3000": 8, "4000": 8, "5000": 8, "6000": 8, "7000": 8, "8000": 8, "9000": 8, "ones_lik": 8, "reshap": 8, "0796": 8}, "objects": {"twiss": [[2, 0, 0, "-", "convert"], [3, 0, 0, "-", "invariant"], [4, 0, 0, "-", "math"], [5, 0, 0, "-", "matrix"], [6, 0, 0, "-", "normal"], [7, 0, 0, "-", "transport"], [8, 0, 0, "-", "twiss"]], "twiss.convert": [[2, 1, 1, "", "cs_to_wolski"], [2, 1, 1, "", "lb_to_wolski"], [2, 1, 1, "", "wolski_to_cs"], [2, 1, 1, "", "wolski_to_lb"]], "twiss.invariant": [[3, 1, 1, "", "cs_invariant"], [3, 1, 1, "", "invariant"], [3, 1, 1, "", "lb_invariant"]], "twiss.math": [[4, 1, 1, "", "mod"]], "twiss.matrix": [[5, 1, 1, "", "is_symplectic"], [5, 1, 1, "", "projection"], [5, 1, 1, "", "rotation"], [5, 1, 1, "", "rotation_block"], [5, 1, 1, "", "symplectic_block"], [5, 1, 1, "", "symplectic_identity"], [5, 1, 1, "", "symplectic_inverse"], [5, 1, 1, "", "symplectify"]], "twiss.normal": [[6, 1, 1, "", "cs_normal"], [6, 1, 1, "", "lb_normal"], [6, 1, 1, "", "normal_to_wolski"], [6, 1, 1, "", "parametric"], [6, 1, 1, "", "wolski_to_normal"]], "twiss.transport": [[7, 1, 1, "", "cs_transport"], [7, 1, 1, "", "lb_transport"], [7, 1, 1, "", "momenta"], [7, 1, 1, "", "transport"], [7, 1, 1, "", "wolski_transport"]], "twiss.twiss": [[8, 1, 1, "", "advance"], [8, 1, 1, "", "is_stable"], [8, 1, 1, "", "propagate"], [8, 1, 1, "", "twiss"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"exampl": [0, 1], "01": 0, "coupl": 0, "twiss": [0, 1, 8], "paramet": 0, "02": 0, "tune": 0, "deriv": 0, "03": 0, "04": 0, "phase": 0, "advanc": 0, "05": 0, "uncertainti": 0, "from": 0, "systemat": 0, "error": 0, "06": 0, "match": 0, "compos": 0, "07": 0, "autograd": 0, "08": 0, "taylor": 0, "model": 0, "welcom": 1, "": 1, "document": 1, "api": 1, "indic": 1, "tabl": 1, "convert": 2, "invari": 3, "math": 4, "matrix": 5, "normal": 6, "transport": 7}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Example-01: Coupled twiss parameters": [[0, "Example-01:-Coupled-twiss-parameters"]], "Example-02: Tune derivatives": [[0, "Example-02:-Tune-derivatives"]], "Example-03: Twiss derivatives": [[0, "Example-03:-Twiss-derivatives"]], "Example-04: Phase advance derivatives": [[0, "Example-04:-Phase-advance-derivatives"]], "Example-05: Tune uncertainty from systematic errors": [[0, "Example-05:-Tune-uncertainty-from-systematic-errors"]], "Example-06: Matching (composable)": [[0, "Example-06:-Matching-(composable)"]], "Example-07: Matching (autograd)": [[0, "Example-07:-Matching-(autograd)"]], "Example-08: Matching (autograd & taylor model)": [[0, "Example-08:-Matching-(autograd-&-taylor-model)"]], "Welcome to twiss\u2019s documentation!": [[1, "welcome-to-twiss-s-documentation"]], "Examples:": [[1, null]], "API:": [[1, null]], "Indices and tables": [[1, "indices-and-tables"]], "Convert": [[2, "convert"]], "Invariant": [[3, "invariant"]], "Math": [[4, "math"]], "Matrix": [[5, "matrix"]], "Normal": [[6, "normal"]], "Transport": [[7, "transport"]], "Twiss": [[8, "twiss"]]}, "indexentries": {"cs_to_wolski() (in module twiss.convert)": [[2, "twiss.convert.cs_to_wolski"]], "lb_to_wolski() (in module twiss.convert)": [[2, "twiss.convert.lb_to_wolski"]], "module": [[2, "module-twiss.convert"], [3, "module-twiss.invariant"], [4, "module-twiss.math"], [5, "module-twiss.matrix"], [6, "module-twiss.normal"], [7, "module-twiss.transport"], [8, "module-twiss.twiss"]], "twiss.convert": [[2, "module-twiss.convert"]], "wolski_to_cs() (in module twiss.convert)": [[2, "twiss.convert.wolski_to_cs"]], "wolski_to_lb() (in module twiss.convert)": [[2, "twiss.convert.wolski_to_lb"]], "cs_invariant() (in module twiss.invariant)": [[3, "twiss.invariant.cs_invariant"]], "invariant() (in module twiss.invariant)": [[3, "twiss.invariant.invariant"]], "lb_invariant() (in module twiss.invariant)": [[3, "twiss.invariant.lb_invariant"]], "twiss.invariant": [[3, "module-twiss.invariant"]], "mod() (in module twiss.math)": [[4, "twiss.math.mod"]], "twiss.math": [[4, "module-twiss.math"]], "is_symplectic() (in module twiss.matrix)": [[5, "twiss.matrix.is_symplectic"]], "projection() (in module twiss.matrix)": [[5, "twiss.matrix.projection"]], "rotation() (in module twiss.matrix)": [[5, "twiss.matrix.rotation"]], "rotation_block() (in module twiss.matrix)": [[5, "twiss.matrix.rotation_block"]], "symplectic_block() (in module twiss.matrix)": [[5, "twiss.matrix.symplectic_block"]], "symplectic_identity() (in module twiss.matrix)": [[5, "twiss.matrix.symplectic_identity"]], "symplectic_inverse() (in module twiss.matrix)": [[5, "twiss.matrix.symplectic_inverse"]], "symplectify() (in module twiss.matrix)": [[5, "twiss.matrix.symplectify"]], "twiss.matrix": [[5, "module-twiss.matrix"]], "cs_normal() (in module twiss.normal)": [[6, "twiss.normal.cs_normal"]], "lb_normal() (in module twiss.normal)": [[6, "twiss.normal.lb_normal"]], "normal_to_wolski() (in module twiss.normal)": [[6, "twiss.normal.normal_to_wolski"]], "parametric() (in module twiss.normal)": [[6, "twiss.normal.parametric"]], "twiss.normal": [[6, "module-twiss.normal"]], "wolski_to_normal() (in module twiss.normal)": [[6, "twiss.normal.wolski_to_normal"]], "cs_transport() (in module twiss.transport)": [[7, "twiss.transport.cs_transport"]], "lb_transport() (in module twiss.transport)": [[7, "twiss.transport.lb_transport"]], "momenta() (in module twiss.transport)": [[7, "twiss.transport.momenta"]], "transport() (in module twiss.transport)": [[7, "twiss.transport.transport"]], "twiss.transport": [[7, "module-twiss.transport"]], "wolski_transport() (in module twiss.transport)": [[7, "twiss.transport.wolski_transport"]], "advance() (in module twiss.twiss)": [[8, "twiss.twiss.advance"]], "is_stable() (in module twiss.twiss)": [[8, "twiss.twiss.is_stable"]], "propagate() (in module twiss.twiss)": [[8, "twiss.twiss.propagate"]], "twiss() (in module twiss.twiss)": [[8, "twiss.twiss.twiss"]], "twiss.twiss": [[8, "module-twiss.twiss"]]}})